{"ast":null,"code":"import React,{useState,useEffect}from'react';import'codemirror/lib/codemirror.css';import'codemirror/theme/material.css';import'codemirror/mode/javascript/javascript';import{Controlled as ControlledEditor}from'react-codemirror2';import'./Editor.css';import io from'socket.io-client';import{useParams,useLocation,useNavigate}from'react-router-dom';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const socket=io.connect(\"https://moveo-project-backend.onrender.com\",{transports:['websocket']});export default function Editor(props){const[userCount,setUserCount]=useState(0);const[editorCode,setEditorCode]=useState(\"\");const[titleName,setTitleName]=useState(\"unamed project\");const[mentor,setMentor]=useState(false);const[isCodeCorrect,setIsCodeCorrect]=useState(false);const{id}=useParams();const location=useLocation();const navigate=useNavigate();let expectedCode=\"\";function handleChange(editor,data,code){socket.emit('codeChange',code);setEditorCode(code);//onChange(code);\ncheckCodeCorrectness(code);}function checkCodeCorrectness(code){setIsCodeCorrect(code===expectedCode);}//fetch data from api\nuseEffect(()=>{if(id){axios.get(`https://moveo-project-backend.onrender.com/api/codes/${id}`).then(res=>{setTitleName(res.data.name);setEditorCode(res.data.currcodes);expectedCode=res.data.expectedcodes;}).catch(error=>{console.error('Error fetching code:',error);});}},[id]);//handle socket\nuseEffect(()=>{const room=location.pathname;// Use pathname as room identifier\nsocket.emit('joinRoom',room);//  incoming user count updates\nsocket.on('userCount',count=>{setUserCount(count);});//code updated\nsocket.on('codeUpdate',newCode=>{setEditorCode(newCode);checkCodeCorrectness(newCode);});//redirect to home page when mentor disconnects\nsocket.on('mentorDisconnect',()=>{navigate('/');});socket.on('isMentor',isMentor=>{setMentor(isMentor);});return()=>{socket.off('userCount');socket.off('codeUpdate');};},[location.pathname]);//create component\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"editor-container\",children:[isCodeCorrect&&/*#__PURE__*/_jsx(\"div\",{className:\"correct-code-indicator\",children:\"\\u2714\\uFE0F Code is correct! \"}),/*#__PURE__*/_jsxs(\"div\",{className:\"titles-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"project-name-title\",children:/*#__PURE__*/_jsxs(\"div\",{children:[titleName,\" \"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-state-title\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Hello \",mentor?\"Tom\":\" student\",\" \"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"number of active users \",userCount,\" \"]})]})]}),/*#__PURE__*/_jsx(ControlledEditor,{onBeforeChange:handleChange,value:editorCode,className:\"code-mirror-wrapper\",options:{lineNumbers:true,lineWrapping:true,lint:true,theme:'material',mode:\"javascript\",readOnly:mentor}})]});}","map":{"version":3,"names":["React","useState","useEffect","Controlled","ControlledEditor","io","useParams","useLocation","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","socket","connect","transports","Editor","props","userCount","setUserCount","editorCode","setEditorCode","titleName","setTitleName","mentor","setMentor","isCodeCorrect","setIsCodeCorrect","id","location","navigate","expectedCode","handleChange","editor","data","code","emit","checkCodeCorrectness","get","then","res","name","currcodes","expectedcodes","catch","error","console","room","pathname","on","count","newCode","isMentor","off","className","children","onBeforeChange","value","options","lineNumbers","lineWrapping","lint","theme","mode","readOnly"],"sources":["C:/Users/is/Desktop/Ran/FS/Moveo project/client/src/components/editor.js"],"sourcesContent":["import React, {useState,useEffect} from 'react'\r\nimport 'codemirror/lib/codemirror.css'\r\nimport 'codemirror/theme/material.css'\r\nimport 'codemirror/mode/javascript/javascript' \r\nimport {Controlled as ControlledEditor} from 'react-codemirror2'\r\nimport './Editor.css'\r\nimport io from 'socket.io-client';\r\nimport { useParams,useLocation,useNavigate  } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nconst socket = io.connect(\"https://moveo-project-backend.onrender.com\",{ transports : ['websocket'] })\r\n\r\nexport default function Editor(props) {\r\n    const [userCount, setUserCount] = useState(0);\r\n    const [editorCode, setEditorCode] = useState(\"\");\r\n    const [titleName, setTitleName] = useState(\"unamed project\");\r\n    const [mentor,setMentor] = useState(false);\r\n    const [isCodeCorrect, setIsCodeCorrect] = useState(false);\r\n    const { id } = useParams();\r\n    const location = useLocation();\r\n    const navigate = useNavigate();\r\n    let expectedCode=\"\";\r\n\r\n    function handleChange(editor,data,code){\r\n        socket.emit('codeChange', code);\r\n        setEditorCode(code);\r\n        //onChange(code);\r\n        checkCodeCorrectness(code);\r\n    }\r\n    function checkCodeCorrectness(code) {\r\n        setIsCodeCorrect(code === expectedCode);\r\n    }\r\n    //fetch data from api\r\n    useEffect(() => {\r\n        if (id) {\r\n            axios.get(`https://moveo-project-backend.onrender.com/api/codes/${id}`)\r\n                .then(res => {\r\n                    setTitleName(res.data.name)\r\n                    setEditorCode(res.data.currcodes); \r\n                    expectedCode = (res.data.expectedcodes);\r\n                })\r\n                .catch(error => {\r\n                    console.error('Error fetching code:', error);\r\n                });\r\n        }\r\n    }, [id]);\r\n\r\n    //handle socket\r\n    useEffect(() => {\r\n        const room = location.pathname; // Use pathname as room identifier\r\n        \r\n        socket.emit('joinRoom', room);\r\n    \r\n        //  incoming user count updates\r\n        socket.on('userCount', (count) => {\r\n          setUserCount(count);\r\n        });\r\n\r\n        //code updated\r\n        socket.on('codeUpdate', (newCode) => {\r\n            setEditorCode(newCode);\r\n            checkCodeCorrectness(newCode);\r\n        });\r\n        //redirect to home page when mentor disconnects\r\n        socket.on('mentorDisconnect', () => {\r\n            navigate('/');\r\n        });\r\n\r\n        socket.on('isMentor', (isMentor) =>{\r\n            setMentor(isMentor)\r\n        })\r\n\r\n        return () => {\r\n          socket.off('userCount');\r\n          socket.off('codeUpdate');\r\n        };\r\n      }, [location.pathname]);\r\n\r\n      //create component\r\n    return (\r\n    <div className=\"editor-container\">\r\n         {isCodeCorrect && <div className=\"correct-code-indicator\">✔️ Code is correct! </div>}\r\n        <div className='titles-container'>\r\n            <div className=\"project-name-title\">\r\n                <div>{titleName} </div>\r\n            </div>\r\n            <div className=\"user-state-title\">\r\n                <div>Hello {mentor ?\"Tom\":\" student\"} </div>\r\n                <div>number of active users {userCount} </div>\r\n            </div>\r\n        </div>\r\n    <ControlledEditor \r\n    onBeforeChange={handleChange}\r\n    value = {editorCode}\r\n    className='code-mirror-wrapper'\r\n    options={{\r\n        lineNumbers: true,\r\n        lineWrapping :true,\r\n        lint: true,\r\n        theme: 'material',\r\n        mode: \"javascript\",\r\n        readOnly: mentor,\r\n    }}\r\n    />\r\n    </div>\r\n  )\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}